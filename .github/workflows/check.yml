name: Check
on: [push, pull_request]

jobs:
    all:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - name: Set up JDK 11
              uses: actions/setup-java@v2
              with:
                  java-version: "11"
                  distribution: "adopt"
            - name: Set up clang format
              run: |
                  sudo apt-get install clang-format-12
                  sudo ln -sf /usr/bin/clang-format-12 /usr/bin/clang-format
                  sed -i 's/def clangFormatVersion = "clang-format /def clangFormatVersion = "clang-format-12 /g' build.gradle
            - name: Make gradlew executable
              run: chmod +x ./gradlew
            - name: Install roboRIO Toolchain
              run: ./gradlew installRoboRioToolchain
            - name: Run Tests
              run: ./gradlew check
            - name: Build All
              run: ./gradlew build
